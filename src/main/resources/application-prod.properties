# ============================================
# APPLICATION PROPERTIES - PRODUCTION
# ============================================
# Use: java -Dquarkus.profile=prod -jar target/notification-engine.jar

# ============================================
# DATABASE CONFIGURATION - Production PostgreSQL
# ============================================
# Configure via environment variables in production
quarkus.datasource.jdbc.url=${DB_JDBC_URL}
quarkus.datasource.username=${DB_USERNAME}
quarkus.datasource.password=${DB_PASSWORD}
quarkus.datasource.jdbc.initial-size=10
quarkus.datasource.jdbc.max-size=50
quarkus.datasource.jdbc.idle-removal-interval=5M
quarkus.datasource.jdbc.max-lifetime=30M

# Hibernate Configuration - NEVER use drop-and-create or update in production
quarkus.hibernate-orm.database.generation=validate
quarkus.hibernate-orm.log.sql=false
quarkus.hibernate-orm.log.bind-param=false
quarkus.hibernate-orm.mapping.format.global=ignore

# Server Configuration
quarkus.http.port=${HTTP_PORT:8082}
quarkus.http.host=0.0.0.0

# Logging - Produção (menos verboso)
quarkus.log.level=INFO
quarkus.log.category."com.apporte".level=INFO
quarkus.log.category."io.quarkus".level=WARN
quarkus.log.category."org.hibernate".level=WARN
quarkus.log.console.json=true
quarkus.log.console.format=%d{yyyy-MM-dd HH:mm:ss} %-5p [%c{1.}] %s%e%n
quarkus.log.file.enable=true
quarkus.log.file.path=/var/log/notification-engine/application.log
quarkus.log.file.rotation.max-file-size=10M
quarkus.log.file.rotation.max-backup-index=10

# CORS Configuration
quarkus.http.cors=true
quarkus.http.cors.origins=${CORS_ORIGINS:https://apporte.work}
quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS,PATCH
quarkus.http.cors.headers=Content-Type,Authorization,X-Requested-With,Accept

# Health Checks
quarkus.health.enabled=true
quarkus.smallrye-health.root-path=/q/health

# Metrics
quarkus.micrometer.enabled=true
quarkus.micrometer.export.prometheus.enabled=true

# Development Features (DISABLED in production)
quarkus.devservices.enabled=false
quarkus.live-reload.instrumentation=false

# ============================================
# KEYCLOAK OIDC CONFIGURATION
# ============================================
quarkus.oidc.enabled=true
quarkus.oidc.auth-server-url=${OIDC_AUTH_SERVER_URL}
quarkus.oidc.client-id=${OIDC_CLIENT_ID}
quarkus.oidc.credentials.secret=${OIDC_CLIENT_SECRET}
quarkus.oidc.token.issuer=${OIDC_ISSUER}
quarkus.oidc.roles.source=accesstoken
quarkus.oidc.roles.role-claim-path=realm_access/roles

# Security
quarkus.oidc.tls.verification=required
quarkus.http.auth.permission.public.paths=/q/health/*,/q/metrics
quarkus.http.auth.permission.public.policy=permit
quarkus.http.auth.permission.authenticated.paths=/*
quarkus.http.auth.permission.authenticated.policy=authenticated

# Swagger (DISABLED in production)
quarkus.swagger-ui.always-include=false

# Email Configuration (real SMTP em prod)
quarkus.mailer.from=${EMAIL_FROM}
quarkus.mailer.mock=false
quarkus.mailer.host=${SMTP_HOST}
quarkus.mailer.port=${SMTP_PORT}
quarkus.mailer.username=${SMTP_USERNAME}
quarkus.mailer.password=${SMTP_PASSWORD}
quarkus.mailer.start-tls=REQUIRED
quarkus.mailer.auth=REQUIRED
