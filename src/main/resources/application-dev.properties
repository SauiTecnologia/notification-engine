# ============================================
# APPLICATION PROPERTIES - DEVELOPMENT
# ============================================
# Use: ./mvnw quarkus:dev

# ============================================
# DATABASE CONFIGURATION - Supabase PostgreSQL
# ============================================
quarkus.datasource.jdbc.url=${DB_JDBC_URL:jdbc:postgresql://db.rpkqbesfgjdeolketoug.supabase.co:5432/postgres?sslmode=require}
quarkus.datasource.username=${DB_USERNAME:workflow_backend}
quarkus.datasource.password=${DB_PASSWORD}
quarkus.datasource.jdbc.initial-size=${DB_POOL_MIN_SIZE:2}
quarkus.datasource.jdbc.max-size=${DB_POOL_MAX_SIZE:5}

# Hibernate Configuration
quarkus.hibernate-orm.database.generation=update
quarkus.hibernate-orm.log.sql=false
quarkus.hibernate-orm.log.bind-param=false
quarkus.hibernate-orm.mapping.format.global=ignore

# Quarkus Application
quarkus.application.name=notification-engine
quarkus.application.version=1.0.0-SNAPSHOT

# Server Configuration
quarkus.http.port=8082
quarkus.http.test-port=8083

# Logging - Desenvolvimento (OTIMIZADO)
quarkus.log.level=INFO
quarkus.log.category."com.apporte".level=INFO
quarkus.log.category."io.quarkus.oidc".level=INFO
quarkus.log.category."io.quarkus".level=WARN
quarkus.log.category."org.hibernate".level=WARN
quarkus.log.console.format=%d{HH:mm:ss} %-5p [%c{2.}] (%t) %s%e%n
quarkus.log.file.enable=false

# CORS Configuration (desenvolvimento)
quarkus.http.cors=true
quarkus.http.cors.origins=http://localhost:3000,http://localhost:3001,http://localhost:8080
quarkus.http.cors.methods=GET,POST,PUT,DELETE,OPTIONS,PATCH
quarkus.http.cors.headers=Content-Type,Authorization,X-Requested-With,Accept

# Health Checks
quarkus.health.enabled=true
quarkus.smallrye-health.root-path=/q/health

# Metrics (desabilitado em dev para performance)
quarkus.micrometer.enabled=false

# Development Features
quarkus.devservices.enabled=false
quarkus.live-reload.instrumentation=true

# Debug Port (diferente do workflow-engine que usa 5005)
quarkus.debug.port=5006

# Jackson Configuration
quarkus.jackson.serialization-inclusion=NON_NULL
quarkus.jackson.write-dates-as-timestamps=false

# ============================================
# KEYCLOAK OIDC CONFIGURATION
# ============================================
quarkus.oidc.enabled=${OIDC_ENABLED:true}
quarkus.oidc.auth-server-url=${OIDC_AUTH_SERVER_URL:https://auth.apporte.work/realms/development}
quarkus.oidc.client-id=${OIDC_CLIENT_ID:notification-engine-dev}
quarkus.oidc.credentials.secret=${OIDC_CLIENT_SECRET}

# Token configuration
quarkus.oidc.token.issuer=${OIDC_ISSUER:https://auth.apporte.work/realms/development}
quarkus.oidc.token.audience=account

# Roles mapping
quarkus.oidc.roles.source=accesstoken
quarkus.oidc.roles.role-claim-path=realm_access/roles

# Security - Endpoints públicos
quarkus.oidc.tls.verification=required
quarkus.http.auth.permission.public.paths=/q/health/*,/q/metrics,/api/auth/health,/swagger-ui/*,/openapi
quarkus.http.auth.permission.public.policy=permit
quarkus.http.auth.permission.authenticated.paths=/*
quarkus.http.auth.permission.authenticated.policy=authenticated

# Email Configuration (mock em dev)
quarkus.mailer.from=${EMAIL_FROM:noreply@apporte.com}
quarkus.mailer.mock=${EMAIL_MOCK:true}

# Keycloak Admin API (opcional - para gerenciamento de usuários)
app.keycloak.admin.server-url=${KEYCLOAK_ADMIN_URL:http://localhost:8180/auth/admin/realms/development}
app.keycloak.admin.username=${KEYCLOAK_ADMIN_USERNAME:admin}
app.keycloak.admin.password=${KEYCLOAK_ADMIN_PASSWORD:admin}
